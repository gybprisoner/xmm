{"remainingRequest":"D:\\project_movie_1902-master\\movie\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project_movie_1902-master\\movie\\src\\components\\Mvshopping.vue?vue&type=style&index=0&id=dc858cbe&scoped=true&lang=css","dependencies":[{"path":"D:\\project_movie_1902-master\\movie\\src\\components\\Mvshopping.vue","mtime":1561117657000},{"path":"D:\\project_movie_1902-master\\movie\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\project_movie_1902-master\\movie\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907989000},{"path":"D:\\project_movie_1902-master\\movie\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\project_movie_1902-master\\movie\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1561445008106},{"path":"D:\\project_movie_1902-master\\movie\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import \"../assets/css/shopping.css\";\n",{"version":3,"sources":["Mvshopping.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+XA","file":"Mvshopping.vue","sourceRoot":"src\\components","sourcesContent":["<template>\n    <div class=\"sp_bg\">\n        <div v-show=\"show2\">\n            <div class=\"pos\"></div>\n        \n            <div class=\"sp_top\"> <!-- 页头 -->\n                <div class=\"icon-lunbo-jiantouzuo iconfont sp_float\" @click=\"goback\"></div>\n                <div class=\"sp_top_sp\">购物车({{this.shun}})</div>\n                <div class=\"shourigth\"><span @click=\"spshou\">首页</span></div>\n            </div>\n            <div>\n                <div class=\"wupin_zong\" v-for=\"(item,index) of shujuku\" :key=\"index\"><!--商品总div-->\n                    <div class=\"gu\">\n                        <div class=\"gu_1\">\n                            <div class=\"gu_1_l\">\n                                <div class=\"iconfont icon-shangdian\"></div>\n                                <p> {{item.date}}-{{item.time}}</p>\n                                <div class=\"icon-lunbo-jiantouyou iconfont \"></div>\n                            </div>\n                            <div>\n                                <p @click=\"redact\">{{qiehuan}}</p>\n                            </div>\n                        </div>  \n                    </div>\n                \n                    <div class=\"wupin\">\n                        <div class=\"wupin_inp\">\n                            <input type=\"checkbox\" @change=\"xuan\" @click=\"xia(index)\"    ref=\"duzi\"><!--选中按钮-->\n                        </div>\n                        <div class=\"wupin_img\">\n                            <img :src=\"require(`../assets/ysg/${item.img}`)\">\n                        </div>\n                        <div class=\"wupin_intro\">\n                            <p class=\"wupin_intro_p1\">{{item.title}}</p>\n                            <p class=\"wupin_intro_p2\">{{item.seat}}</p>\n                            <div class=\"wupin_add\">\n                                <div class=\"wupin_money\">\n                                    <span>￥</span>\n                                    <span>{{item.price}}</span>\n                                </div>\n                                <div class=\"wupin_but\">\n                                    <button @click=\"min(index)\">-</button >\n                                    <input type=\"text\" class=\"add_inp\" v-model=\"item.count\"  readonly>\n                                    <button @click=\"add(index)\">+</button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>  \n            </div>\n\n            <div class=\"wupin_bto\"  v-if=\"this.dibu==true\"> <!--底部结算导航-->\n                <div class=\"bto_quan\">\n                    <mt-checklist v-model=\"value\" :options=\"options\" @change=\"quanbu\" ref=\"qx\">\n                    </mt-checklist >\n                    <!-- <input type=\"checkbox\" @change=\"quanbu\" ref=\"qx\"> -->\n                    <!-- <p  >全选</p> -->\n                </div>\n\n                <div class=\"bto_he\">\n                    <div class=\"bto_he_money\">\n                        <p>合计：</p>\n                        <span class=\"bto_he_s1\">￥</span>\n                        <span class=\"bto_he_s2\">{{qian.toFixed(2)}}</span>\n                    </div>\n                    <div class=\"bto_he_jie\" @click=\"jiesuan\">结算({{shu}})</div>\n                </div>\n            </div>\n\n\n            <div class=\"wupin_bto\" v-else-if=\"this.dibu==false\"> <!--底部删除导航-->\n                <div class=\"bto_quan\">\n                    <!-- <input type=\"checkbox\"  ref=\"qx\"   @change=\"quanbu\"> -->\n                     <mt-checklist v-model=\"value\" :options=\"options\" @change=\"quanbu\" ref=\"qx\">\n                    </mt-checklist >\n                    <!-- <p >全选</p> -->\n                </div>\n\n                <div class=\"bto_he\">\n                    <div class=\"bto_he_money  kong\">\n                    </div>\n                    <div class=\"bto_he_jie shanchu\" @click=\"del\">删除({{delsum}})</div>\n                </div>\n            </div>\n            <div class=\"btbt\">\n\n            </div>\n        </div>\n        <erweima @click.native=\"saoma\" v-show=\"show\"></erweima>\n    </div>\n</template>\n\n<script>\nimport erweima from './Mverweima';\nexport default {\n    data() {\n        return {\n            danxuan:0,//保存下标\n            qian:0,//保存总计的总价\n            shu:0,//选中的数量\n            shun:0,//购物车总数量\n            dibu:true,//控制底部导航的切换\n            qiehuan:\"编辑\",\n            delsum:0,//删除的数量\n            tf:false,\n            shujuku:[],\n            show:false,//控制二维码\n            show2:true,//控制页面\n            quanshu:0,//购物车为空时，不能使用全选按钮\n            value:[],\n            options : [{\n\t\t  label: '全选',\n\t\t  value: 'A'\n\t\t\t},\n\t\t\t]\n        }\n    },\n    components:{\n        erweima,\n    },\n    methods:{\n        min(e){//减法函数\n            for(var i=0;i<this.shujuku.length;i++){\n                if(e==i){\n                    if(this.shujuku[i].count>1){\n                        this.shujuku[i].count--;\n                    }else{\n                        return;\n                    };\n                    \n                };\n            };\n           this.jiajian();//调用计算总计函数\n        },\n        add(s){//加法函数\n            \n            for(var i=0;i<this.shujuku.length;i++){\n                if(s==i){\n                    if(this.shujuku[i].count<100){\n                       this.shujuku[i].count++;\n                    }else{\n                        return;\n                    };\n                    \n                };\n            };\n           this.jiajian();//调用计算总计函数\n          \n        },\n        xuan(e){//单个按钮\n        \n            var add=0;//选中价格\n            var min=0;//取消价格\n            var zshu=0;//选中数量\n            var jshu=0;//取消数量\n            var zongshu=0;//删除选中的数量\n            for(var i=0;i<this.shujuku.length;i++){//当前选中的\n                if(e.target.checked==true){\n                    if(this.danxuan==i){\n                        add=this.shujuku[i].count*this.shujuku[i].price;//选中的价格\n                        zshu=this.shujuku[i].count;//选中的数量\n                    };\n                }else{\n                    if(this.danxuan==i){//当前去取消的\n                       min=this.shujuku[i].count*this.shujuku[i].price;//取消的价格\n                       jshu=this.shujuku[i].count;//取消的数量\n                    };\n                };\n                if(this.danxuan==i){//给cd监听状态\n                    this.shujuku[i].cd=e.target.checked\n                };\n\n                if(this.shujuku[i].cd==true){\n                    zongshu++\n                }\n                \n                \n            };\n            this.delsum=zongshu;//删除选中的数量\n            this.qian+=add;//将总计赋值给页面上\n            this.qian-=min;//将总计赋值给页面上\n            this.shu+=zshu//将选中的数量赋值给页面上\n            this.shu-=jshu//将取消选中的数量赋值给页面上\n            var sjj=0//查看有几个选中的\n            var ipn=this.$refs.duzi//独自的按钮\n           // var qx=this.$refs.qx//全选的按钮\n            for(var q of ipn){//让独自按钮控制全选按钮的状态\n                if(q.checked==true){\n                    sjj++\n                }\n                if(sjj==ipn.length){\n                     this.value=[\"A\"]\n                }else{\n                    this.value=[]\n                }\n                \n            }\n            \n        },\n        xia(e){//拿到当前的下标\n            this.danxuan=e;   \n        },\n\n        jiajian(){//加减共用函数\n            this.qian=0;\n             var mo=0;\n             var moshu=0;\n           for(var p of this.shujuku){\n               if(p.cd==true){//为选中转态 才计算\n                   mo+=p.price*p.count\n                   moshu+=p.count\n               }\n           }\n           this.qian=mo//总计\n           this.shu=moshu//结算数量\n        },\n        redact(){//控制编辑和删除的切换\n            if(this.qiehuan==\"编辑\"){\n                this.qiehuan=\"取消\";\n                this.dibu=false;\n            }else{\n                this.qiehuan=\"编辑\";\n                this.dibu=true;\n            }\n             \n        },\n        shuju(){//axios请求\n           this.axios.get(\"product/cart\").then(\n            (result)=>{\n                if(result.data.code==1){\n                    // console.log(result)\n                    var rows=result.data.data;\n                    var n=0;\n                    for(var p of rows){\n                        p.cd=false;//给数组添加一个状态属性\n                        n++\n                    };\n                    this.shun=n;//购物车总数量\n                    this.shujuku=rows\n               }else{\n                   this.$toast(\"亲，去添加自己喜欢的商品吧！\");\n                   this.quanshu=-1\n               }\n            });\n            \n        },\n        quanbu(){//全选按钮\n       \n        var rs=false;\n        if(this.value==0){\n            rs=true\n        }else{\n            rs=false\n        }\n        // console.log(e.disabled)\n       // var rs=e.target.checked//全选 按钮的状态\n            if(this.quanshu==-1){\n                this.$toast(\"购物车为空\");\n                \n            }else{\n\n                \n               // console.log(rs)\n               var sb=0;//全部钱\n               var jie=0//全部数量\n               \n               var qqxx=0;\n               this.qian=0\n               this.shu=0\n               this.delsum=0\n               for(var item of this.shujuku){//下面的选项状态 随全选状态改变\n                   qqxx++\n                   item.cd=rs;\n                   if(rs==true){\n                       sb+=item.price*item.count;\n                       jie+=item.count;\n                      \n                   }\n               }\n               if(rs==true){\n                   this.delsum=qqxx;\n               }\n               \n               this.qian=sb//全部钱\n               this.shu=jie//全部数量\n               // console.log(123)\n               //   console.log(this.shujuku)\n   \n                var ipn=this.$refs.duzi//独自的按钮(让全部按钮的状态控制独自按钮)\n                   if(rs==true){\n                       for(var ii of ipn){\n                           ii.checked=true;\n                       }\n                   }else{\n                       for(var ii of ipn){\n                           ii.checked=false;\n                       }\n                   }\n            }\n        },\n        del(){//删除按钮\n            var id=\"\"\n            for(var d of this.shujuku){\n                if(d.cd==true){\n                    id+=d.id+\",\"\n                }\n            };\n            id=id.substring(0,id.length-1);\n            if(id==\"\"||id==undefined){\n                 this.$toast(\"请选择需要删除的商品\")\n                }else{\n                    this.$messagebox({\n                        title:\"删除商品\",\n                        message:\"确定删除选中的商品吗？\",\n                        showConfirmButton:true,\n                        showCancelButton:true\n                    }).then(result=>{                       \n                        if(result==\"confirm\"){\n                            var url=\"http://localhost:3000/product/del_cart\"; \n                            this.axios.get(url,{params:{id}}).then(result=>{\n                                \n                                var ipn=this.$refs.duzi\n                                for(var che of ipn){\n                                    che.checked=false  \n                                };\n                                //this.shuju();\n                                //this.delsum=0;\n                                history.go(0)\n                            });\n                             \n                        }else{\n                            return;\n                        };\n                    });\n                };\n\n\n\n            \n            \n        },\n        goback(){//返回\n            history.go(-1)\n        },\n        jiesuan(){//控制二维码\n            if(this.shu==0){\n                this.$toast(\"亲，请选择需要支付的商品\")\n            }else{\n                this.show=true;\n                this.show2=false;\n            }\n        },\n        saoma(e){//控制二维码\n           if(e.target.getAttribute(\"class\")==\"iconfont icon-cuo3 p2\"){\n               this.show=false;\n               this.show2=true;\n           }\n        },\n        spshou(){\n            sessionStorage.setItem(\"onon\",\"no1\");\n            this.$router.push(\"/mvhome\")\n        },\n\n    },\n    watch:{\n       \n    },\n    created(){\n        var session=sessionStorage.getItem(\"sessionLogin\");\n        if(session!==null){\n            this.shuju();\n        }else{\n            this.$router.push(\"/dl\")\n        };\n    },\n    mounted(){\n       \n    },\n\n}\n</script>\n\n<style scoped>\n    @import \"../assets/css/shopping.css\";\n</style>\n"]}]}